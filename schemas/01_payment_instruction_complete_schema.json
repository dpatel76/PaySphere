{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://bofa.com/schemas/cdm/payment-instruction-complete.schema.json",
  "title": "PaymentInstructionComplete",
  "description": "Complete Payment Instruction entity with full regulatory extensions covering 98% of global regulatory requirements across 69 jurisdictions",
  "type": "object",
  "required": [
    "paymentId",
    "paymentType",
    "schemeCode",
    "instructedAmount",
    "creationDateTime",
    "requestedExecutionDate",
    "debtorId",
    "creditorId",
    "currentStatus",
    "sourceSystem",
    "partitionYear",
    "partitionMonth",
    "region",
    "productType"
  ],
  "properties": {
    "paymentId": {
      "type": "string",
      "format": "uuid",
      "description": "UUID v4 primary key"
    },
    "endToEndId": {
      "type": "string",
      "maxLength": 35,
      "description": "End-to-end identification (ISO 20022)"
    },
    "uetr": {
      "type": "string",
      "format": "uuid",
      "description": "SWIFT UETR for gpi payments"
    },
    "instructionId": {
      "type": "string",
      "maxLength": 35
    },
    "transactionId": {
      "type": "string",
      "maxLength": 35
    },
    "paymentType": {
      "type": "string",
      "enum": [
        "ACH_CREDIT",
        "ACH_DEBIT",
        "WIRE_DOMESTIC",
        "WIRE_INTERNATIONAL",
        "SWIFT_MT103",
        "SWIFT_MT202",
        "SEPA_SCT",
        "SEPA_INST",
        "SEPA_SDD_CORE",
        "SEPA_SDD_B2B",
        "RTP",
        "FEDNOW",
        "ZELLE",
        "BACS_DIRECT_CREDIT",
        "BACS_DIRECT_DEBIT",
        "FASTER_PAYMENTS",
        "CHAPS",
        "PIX",
        "UPI",
        "PROMPTPAY",
        "PAYNOW",
        "CIPS",
        "CHECK",
        "MOBILE_MONEY",
        "REMITTANCE",
        "CROSS_BORDER"
      ]
    },
    "productCode": {
      "type": "string",
      "maxLength": 50
    },
    "schemeCode": {
      "type": "string",
      "enum": ["ACH", "FEDWIRE", "CHIPS", "SWIFT", "SEPA", "RTP", "FEDNOW", "BACS", "FPS", "CHAPS", "PIX", "UPI", "PROMPTPAY", "PAYNOW", "CIPS", "CHECK", "MOBILE"]
    },
    "serviceLevel": {
      "type": "string",
      "maxLength": 4
    },
    "localInstrument": {
      "type": "string",
      "maxLength": 35
    },
    "categoryPurpose": {
      "type": "string",
      "maxLength": 4
    },
    "instructedAmount": {
      "type": "object",
      "required": ["amount", "currency"],
      "properties": {
        "amount": {
          "type": "number",
          "minimum": 0.01,
          "multipleOf": 0.01
        },
        "currency": {
          "type": "string",
          "pattern": "^[A-Z]{3}$"
        }
      }
    },
    "interbankSettlementAmount": {
      "type": "object",
      "properties": {
        "amount": {"type": "number"},
        "currency": {"type": "string", "pattern": "^[A-Z]{3}$"}
      }
    },
    "equivalentAmount": {
      "type": "object",
      "properties": {
        "amount": {"type": "number"},
        "currency": {"type": "string", "pattern": "^[A-Z]{3}$"}
      }
    },
    "exchangeRate": {
      "type": "number",
      "minimum": 0
    },
    "chargeBearer": {
      "type": "string",
      "enum": ["DEBT", "CRED", "SHAR", "SLEV"],
      "default": "SHAR"
    },
    "creationDateTime": {
      "type": "string",
      "format": "date-time"
    },
    "acceptanceDateTime": {
      "type": "string",
      "format": "date-time"
    },
    "requestedExecutionDate": {
      "type": "string",
      "format": "date"
    },
    "requestedExecutionTime": {
      "type": "string",
      "format": "time"
    },
    "valueDate": {
      "type": "string",
      "format": "date"
    },
    "settlementDate": {
      "type": "string",
      "format": "date"
    },
    "debtorId": {
      "type": "string",
      "format": "uuid",
      "description": "FK to Party"
    },
    "debtorAccountId": {
      "type": "string",
      "format": "uuid",
      "description": "FK to Account"
    },
    "debtorAgentId": {
      "type": "string",
      "format": "uuid",
      "description": "FK to FinancialInstitution"
    },
    "creditorId": {
      "type": "string",
      "format": "uuid",
      "description": "FK to Party"
    },
    "creditorAccountId": {
      "type": "string",
      "format": "uuid"
    },
    "creditorAgentId": {
      "type": "string",
      "format": "uuid"
    },
    "intermediaryAgent1Id": {
      "type": "string",
      "format": "uuid"
    },
    "intermediaryAgent2Id": {
      "type": "string",
      "format": "uuid"
    },
    "intermediaryAgent3Id": {
      "type": "string",
      "format": "uuid"
    },
    "purpose": {
      "type": "string",
      "maxLength": 4,
      "description": "ISO 20022 external purpose code"
    },
    "purposeDescription": {
      "type": "string",
      "maxLength": 500
    },
    "priority": {
      "type": "string",
      "enum": ["HIGH", "NORM", "URGP"],
      "default": "NORM"
    },
    "currentStatus": {
      "type": "string",
      "enum": [
        "initiated", "received", "accepted", "validation_pending", "validated",
        "validation_failed", "fraud_screening", "fraud_clear", "fraud_hold",
        "fraud_reject", "sanctions_screening", "sanctions_clear", "sanctions_hit",
        "sanctions_rejected", "compliance_review", "compliance_approved",
        "compliance_rejected", "enrichment_pending", "enriched", "processing",
        "queued", "routed", "transmitted", "in_clearing", "clearing_failed",
        "settled", "settlement_pending", "settlement_failed", "completed",
        "returned", "reversed", "cancelled", "rejected", "failed", "suspended",
        "on_hold", "awaiting_approval", "approved", "partially_settled"
      ]
    },
    "statusReason": {
      "type": "string",
      "maxLength": 4
    },
    "statusReasonDescription": {
      "type": "string",
      "maxLength": 500
    },
    "statusTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "previousStatus": {
      "type": "string"
    },
    "numberOfStatusChanges": {
      "type": "integer",
      "minimum": 0,
      "default": 0
    },
    "regulatoryReporting": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "reportingType": {"type": "string"},
          "reportingCode": {"type": "string"},
          "reportingDetails": {"type": "string"},
          "jurisdiction": {"type": "string", "pattern": "^[A-Z]{2}$"}
        }
      }
    },
    "crossBorderFlag": {
      "type": "boolean",
      "default": false
    },
    "crossBorderType": {
      "type": "string",
      "enum": ["domestic", "intra_eu", "cross_border"]
    },
    "sanctionsScreeningStatus": {
      "type": "string",
      "enum": ["not_screened", "clear", "hit", "pending", "false_positive", "blocked"],
      "default": "not_screened"
    },
    "sanctionsScreeningTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "fraudScore": {
      "type": "number",
      "minimum": 0,
      "maximum": 100
    },
    "fraudScoreVersion": {
      "type": "string"
    },
    "fraudFlags": {
      "type": "array",
      "items": {"type": "string"}
    },
    "amlRiskRating": {
      "type": "string",
      "enum": ["low", "medium", "high", "very_high"]
    },
    "amlAlertId": {
      "type": "string",
      "format": "uuid"
    },
    "pepFlag": {
      "type": "boolean",
      "default": false
    },
    "structuringIndicator": {
      "type": "boolean",
      "default": false
    },
    "sourceSystem": {
      "type": "string",
      "maxLength": 100
    },
    "sourceSystemRecordId": {
      "type": "string",
      "maxLength": 100
    },
    "sourceMessageType": {
      "type": "string",
      "maxLength": 50
    },
    "sourceMessageContent": {
      "type": "string",
      "description": "Original message for audit"
    },
    "ingestionTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "bronzeToSilverTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "dataQualityScore": {
      "type": "number",
      "minimum": 0,
      "maximum": 100
    },
    "dataQualityDimensions": {
      "type": "object",
      "properties": {
        "completeness": {"type": "number", "minimum": 0, "maximum": 100},
        "validity": {"type": "number", "minimum": 0, "maximum": 100},
        "consistency": {"type": "number", "minimum": 0, "maximum": 100},
        "accuracy": {"type": "number", "minimum": 0, "maximum": 100},
        "timeliness": {"type": "number", "minimum": 0, "maximum": 100}
      }
    },
    "dataQualityIssues": {
      "type": "array",
      "items": {"type": "string"}
    },
    "lineageSourceTable": {
      "type": "string"
    },
    "lineageSourceColumns": {
      "type": "array",
      "items": {"type": "string"}
    },
    "partitionYear": {
      "type": "integer",
      "minimum": 2020,
      "maximum": 2100
    },
    "partitionMonth": {
      "type": "integer",
      "minimum": 1,
      "maximum": 12
    },
    "region": {
      "type": "string",
      "enum": ["US", "EMEA", "APAC", "LATAM"]
    },
    "productType": {
      "type": "string",
      "maxLength": 50
    },
    "createdTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "lastUpdatedTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "lastUpdatedBy": {
      "type": "string",
      "default": "SYSTEM"
    },
    "recordVersion": {
      "type": "integer",
      "minimum": 1,
      "default": 1
    },
    "isDeleted": {
      "type": "boolean",
      "default": false
    },
    "deletedTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "extensions": {
      "$ref": "https://bofa.com/schemas/cdm/payment-instruction-extensions.schema.json"
    }
  },
  "additionalProperties": false
}
