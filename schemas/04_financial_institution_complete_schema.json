{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://bofa.com/schemas/cdm/financial-institution-complete.schema.json",
  "title": "FinancialInstitutionComplete",
  "description": "Complete FinancialInstitution entity with FinCEN requirements and Islamic finance extensions",
  "type": "object",
  "required": ["financialInstitutionId", "institutionName", "country", "effectiveFrom", "isCurrent"],
  "properties": {
    "financialInstitutionId": {
      "type": "string",
      "format": "uuid"
    },
    "institutionName": {
      "type": "string",
      "maxLength": 140
    },
    "bic": {
      "type": ["string", "null"],
      "pattern": "^[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?$",
      "description": "SWIFT BIC (8 or 11 characters)"
    },
    "lei": {
      "type": ["string", "null"],
      "pattern": "^[A-Z0-9]{20}$",
      "description": "Legal Entity Identifier (20 characters)"
    },
    "nationalClearingCode": {
      "type": ["string", "null"],
      "maxLength": 35,
      "description": "BSB, Routing number, Sort code, etc."
    },
    "nationalClearingSystem": {
      "type": ["string", "null"],
      "enum": ["USABA", "AUBSB", "GBSORTCODE", "CACPA", "DEBLZ", "FRBANKCODE", "CHBC", "INFED", "BRCOMPE", null],
      "description": "National clearing system code"
    },
    "rssdNumber": {
      "type": ["string", "null"],
      "pattern": "^[0-9]{10}$",
      "description": "FinCEN - RSSD number (10 digits) from Federal Reserve - Non-ISO Extension"
    },
    "tinType": {
      "type": ["string", "null"],
      "enum": ["EIN", "SSN", "ITIN", "FOREIGN", null],
      "description": "FinCEN CTR Item 80/111 - TIN type - Non-ISO Extension"
    },
    "tinValue": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "FinCEN CTR Item 81/112 - Tax Identification Number value - Non-ISO Extension"
    },
    "fiType": {
      "type": ["string", "null"],
      "enum": ["DEPOSITORY_INSTITUTION", "BROKER_DEALER", "MSB", "CASINO", "INSURANCE_COMPANY", "OTHER", null],
      "description": "FinCEN - Financial institution type - Non-ISO Extension"
    },
    "msbRegistrationNumber": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "FinCEN - Money Services Business registration number - Non-ISO Extension"
    },
    "primaryRegulator": {
      "type": ["string", "null"],
      "enum": ["OCC", "FDIC", "FRB", "NCUA", "SEC", "CFTC", "OTHER", null],
      "description": "FinCEN - Primary federal regulator - Non-ISO Extension"
    },
    "branchCountry": {
      "type": ["string", "null"],
      "pattern": "^[A-Z]{2}$",
      "description": "FinCEN - Branch country (ISO 3166-1 alpha-2) - ISO 20022 Compliant"
    },
    "branchState": {
      "type": ["string", "null"],
      "maxLength": 3,
      "description": "FinCEN - Branch state/province - ISO 20022 Compliant"
    },
    "shariaCompliantFlag": {
      "type": "boolean",
      "default": false,
      "description": "Islamic finance / Sharia-compliant institution flag - Non-ISO Extension"
    },
    "islamicFinanceType": {
      "type": ["string", "null"],
      "enum": ["FULLY_SHARIA_COMPLIANT", "SHARIA_COMPLIANT_WINDOW", "TAKAFUL_PROVIDER", "SUKUK_ISSUER", "CONVENTIONAL", null],
      "description": "Type of Islamic finance institution - Non-ISO Extension"
    },
    "centralBankLicenseNumber": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Central bank license number (global use) - ISO 20022 Compliant"
    },
    "islamicFinancialServicesBoard": {
      "type": "boolean",
      "default": false,
      "description": "IFSB (Islamic Financial Services Board) member flag - Non-ISO Extension"
    },
    "shariaAdvisoryBoard": {
      "type": "boolean",
      "default": false,
      "description": "Has Sharia advisory board (required for Islamic FIs) - Non-ISO Extension"
    },
    "address": {
      "type": "object",
      "properties": {
        "streetName": {"type": "string", "maxLength": 70},
        "buildingNumber": {"type": "string", "maxLength": 16},
        "postCode": {"type": "string", "maxLength": 16},
        "townName": {"type": "string", "maxLength": 35},
        "countrySubDivision": {"type": "string", "maxLength": 35},
        "country": {"type": "string", "pattern": "^[A-Z]{2}$"}
      },
      "required": ["country"]
    },
    "country": {
      "type": "string",
      "pattern": "^[A-Z]{2}$",
      "description": "ISO 3166-1 alpha-2 country code"
    },
    "branchIdentification": {
      "type": ["string", "null"],
      "maxLength": 35
    },
    "branchName": {
      "type": ["string", "null"],
      "maxLength": 140
    },
    "effectiveFrom": {
      "type": "string",
      "format": "date"
    },
    "effectiveTo": {
      "type": ["string", "null"],
      "format": "date"
    },
    "isCurrent": {
      "type": "boolean"
    },
    "sourceSystem": {
      "type": "string",
      "maxLength": 100
    },
    "createdTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "lastUpdatedTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "lastUpdatedBy": {
      "type": "string"
    },
    "recordVersion": {
      "type": "integer",
      "minimum": 1,
      "default": 1
    },
    "isDeleted": {
      "type": "boolean",
      "default": false
    }
  },
  "additionalProperties": false
}
